<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="utf-8" />
    <title>So sánh sản phẩm - LaptopShop</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="/client/css/bootstrap.min.css" rel="stylesheet" />
    <link href="/client/lib/lightbox/css/lightbox.min.css" rel="stylesheet" />
    <link href="/client/lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet" />
    <link href="/client/css/style.css" rel="stylesheet" />
    <link rel="stylesheet" href="/client/css/product/compare.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">


</head>

<body>
    <!-- Navbar start -->
    <%- include('../client/layout/header'); -%>


        <% if (user) { %>
            <script>
                window.USER_ID = "<%= String(user.id) %>";
            </script>
            <% } %>

                <!-- Socket.IO client -->
                <script src="/socket.io/socket.io.js"></script>
                <script>
                    (function () {
                        if (!window.USER_ID) return; // chưa login thì thôi

                        const uBadge = document.getElementById('notificationBadge');
                        const uIcon = document.getElementById('notificationDropdown');
                        const uPanel = document.getElementById('uNotificationPanel');
                        const uList = document.getElementById('uNotificationList');
                        const uSound = document.getElementById('notificationSound');
                        const USER_ID = window.USER_ID;

                        // Toggle panel
                        if (uIcon && uPanel) {
                            uIcon.addEventListener('click', () => {
                                const shown = uPanel.style.display === 'block';
                                uPanel.style.display = shown ? 'none' : 'block';
                            });
                        }

                        // Unlock audio lần click đầu vào chuông
                        let audioUnlocked = false;
                        if (uIcon && uSound) {
                            uIcon.addEventListener('click', () => {
                                if (!audioUnlocked) {
                                    uSound.volume = 0.0;
                                    uSound.play().catch(() => { });
                                    setTimeout(() => {
                                        try { uSound.pause(); uSound.currentTime = 0; } catch { }
                                        uSound.volume = 1.0;
                                        audioUnlocked = true;
                                    }, 50);
                                }
                            });
                        }

                        function uUpdateBadge(delta = 1) {
                            if (!uBadge) return;
                            let cur = parseInt(uBadge.textContent || "0", 10);
                            cur = isNaN(cur) ? 0 : cur;
                            cur += delta;
                            if (cur <= 0) {
                                uBadge.style.display = "none";
                                uBadge.textContent = "0";
                            } else {
                                uBadge.style.display = "flex";
                                uBadge.textContent = cur > 9 ? "9+" : String(cur);
                            }
                        }

                        function uPrepend(itemHtml) {
                            if (!uList) return;
                            const li = document.createElement('li');
                            li.className = 'list-group-item';
                            li.innerHTML = itemHtml;
                            uList.prepend(li);
                        }

                        const markBtn = document.getElementById('uMarkAllRead');
                        if (markBtn && uBadge) {
                            markBtn.addEventListener('click', () => {
                                uBadge.style.display = 'none';
                                uBadge.textContent = '0';
                            });
                        }

                        // Socket
                        const uSocket = io(); // same-origin
                        uSocket.on('connect', () => {
                            console.log('[SOCKET] user connected, USER_ID=', USER_ID);
                            uSocket.emit('join-user-room', USER_ID);
                        });

                        // Admin xác nhận
                        uSocket.on('order-confirmed', (data) => {
                            console.log('[SOCKET] order-confirmed:', data);
                            try { if (uSound) { uSound.currentTime = 0; uSound.play(); } } catch { }
                            uUpdateBadge(1);
                            const url = `/order/${data.orderId}`;
                            const msg = data.message || ('Đơn #' + data.orderId + ' đã được xác nhận');
                            uPrepend(
                                '<div class="d-flex justify-content-between align-items-start">' +
                                '<div>' +
                                '<div class="fw-semibold">' + msg + '</div>' +
                                '<small class="text-muted">' + new Date().toLocaleString('vi-VN') + '</small>' +
                                '</div>' +
                                '<a href="' + url + '" class="btn btn-sm btn-primary ms-2">Xem</a>' +
                                '</div>'
                            );
                        });

                        uSocket.on('order-canceled', (data) => {
                            console.log('[SOCKET] order-canceled:', data);
                            try { if (uSound) { uSound.currentTime = 0; uSound.play(); } } catch { }
                            uUpdateBadge(1);
                            const url = `/order/${data.orderId}`;
                            const msg = data.message || ('Đơn #' + data.orderId + ' đã bị hủy');
                            uPrepend(
                                '<div class="d-flex justify-content-between align-items-start">' +
                                '<div>' +
                                '<div class="fw-semibold">' + msg + '</div>' +
                                '<small class="text-muted">' + new Date().toLocaleString('vi-VN') + '</small>' +
                                '</div>' +
                                '<a href="' + url + '" class="btn btn-sm btn-outline-danger ms-2">Xem</a>' +
                                '</div>'
                            );
                        });

                        uSocket.on('order-updated', (data) => {
                            console.log('[SOCKET] order-updated:', data);
                            try { if (uSound) { uSound.currentTime = 0; uSound.play(); } } catch { }
                            uUpdateBadge(1);
                            const url = `/order/${data.orderId}`;
                            const msg = data.message || ('Đơn #' + data.orderId + ' cập nhật: ' + data.status);
                            uPrepend(
                                '<div class="d-flex justify-content-between align-items-start">' +
                                '<div>' +
                                '<div class="fw-semibold">' + msg + '</div>' +
                                '<small class="text-muted">' + new Date().toLocaleString('vi-VN') + '</small>' +
                                '</div>' +
                                '<a href="' + url + '" class="btn btn-sm btn-primary ms-2">Xem</a>' +
                                '</div>'
                            );
                        });
                        uSocket.on('chat-incoming', (data) => {
                            try { if (uSound) { uSound.currentTime = 0; uSound.play(); } } catch { }
                            uUpdateBadge(1);
                            uPrepend(
                                '<div class="d-flex justify-content-between align-items-start">' +
                                '<div>' +
                                '<div class="fw-semibold">Tin nhắn mới từ hỗ trợ</div>' +
                                '<small class="text-muted">' + new Date().toLocaleString('vi-VN') + '</small>' +
                                '</div>' +
                                '<a href="javascript:void(0)" onclick="document.getElementById(\'chatOpen\').click()" class="btn btn-sm btn-primary ms-2">Mở</a>' +
                                '</div>'
                            );
                        });
                    })();
                </script>
                <script>
                    (() => {
                        const form = document.getElementById('headerSearchForm');
                        const input = document.getElementById('headerSearch');
                        const popup = document.getElementById('searchPopup');

                        let timer = null;
                        let activeIndex = -1;
                        let currentItems = []; // giữ dữ liệu gợi ý hiện tại

                        const escapeHtml = (str) => String(str || '').replace(/[&<>"']/g, s => ({
                            '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;'
                        }[s]));

                        const money = (n) => (Number(n || 0)).toLocaleString('vi-VN') + ' ₫';

                        const highlight = (text, q) => {
                            if (!q) return escapeHtml(text);
                            const re = new RegExp('(' + q.replace(/[.*+?^${}()|[\]\\]/g, '\\$&') + ')', 'ig');
                            return escapeHtml(text).replace(re, '<mark>$1</mark>');
                        };

                        // Chuẩn hoá đường dẫn ảnh từ DB
                        const toImg = (v) => {
                            if (!v) return '/images/no-image.png';
                            if (/^https?:\/\//.test(v)) return v;   // URL tuyệt đối
                            if (v.startsWith('/')) return v;        // đã có slash
                            if (v.startsWith('images/')) return '/' + v; // có thư mục sẵn
                            // còn lại coi như chỉ là filename
                            return '/images/product/' + encodeURIComponent(v);
                        };

                        async function fetchSuggest(q) {
                            const url = '/api/suggest?q=' + encodeURIComponent(q);
                            const res = await fetch(url, { credentials: 'same-origin' });
                            if (!res.ok) throw new Error('Network');
                            return res.json();
                        }

                        function render(items, q) {
                            currentItems = items;           // lưu lại để điều hướng bàn phím
                            activeIndex = -1;

                            if (!items.length) {
                                popup.innerHTML = `<div class="empty">Không tìm thấy sản phẩm phù hợp.</div>`;
                                popup.style.display = 'block';
                                return;
                            }

                            popup.innerHTML = items.map((x, i) => {
                                const img = toImg(x.image);
                                const href = `/product/${encodeURIComponent(String(x.id))}`;
                                return `
        <a class="sug-item" data-index="${i}" data-href="${href}" href="${href}">
          <img src="${img}" alt="">
          <div class="flex-1">
            <div class="title">${highlight(x.name, q)}</div>
            <div class="price">${money(x.price)}</div>
          </div>
        </a>
      `;
                            }).join('');

                            // Gán hover để set active
                            popup.querySelectorAll('.sug-item').forEach(el => {
                                el.addEventListener('mouseenter', () => {
                                    setActive(Number(el.dataset.index));
                                });
                            });

                            popup.style.display = 'block';
                        }

                        function hide() {
                            popup.style.display = 'none';
                            activeIndex = -1;
                            currentItems = [];
                        }

                        function setActive(index) {
                            const items = popup.querySelectorAll('.sug-item');
                            items.forEach(a => a.classList.remove('active'));
                            if (items[index]) {
                                items[index].classList.add('active');
                                activeIndex = index;
                            } else {
                                activeIndex = -1;
                            }
                        }

                        input.addEventListener('input', () => {
                            const q = input.value.trim();
                            clearTimeout(timer);
                            if (!q) return hide();
                            timer = setTimeout(async () => {
                                try {
                                    const items = await fetchSuggest(q);
                                    render(items, q);
                                } catch {
                                    hide();
                                }
                            }, 200);
                        });

                        input.addEventListener('focus', () => {
                            if (popup.innerHTML.trim()) popup.style.display = 'block';
                        });

                        document.addEventListener('click', (e) => {
                            if (!popup.contains(e.target) && e.target !== input) hide();
                        });

                        input.addEventListener('keydown', (e) => {
                            const items = popup.querySelectorAll('.sug-item');
                            if (!items.length) return;

                            if (e.key === 'ArrowDown') {
                                e.preventDefault();
                                const next = (activeIndex + 1) % items.length;
                                setActive(next);
                            } else if (e.key === 'ArrowUp') {
                                e.preventDefault();
                                const prev = (activeIndex - 1 + items.length) % items.length;
                                setActive(prev);
                            } else if (e.key === 'Enter') {
                                if (activeIndex >= 0 && items[activeIndex]) {
                                    e.preventDefault();
                                    // Điều hướng thẳng tới sản phẩm đang chọn
                                    const href = items[activeIndex].dataset.href;
                                    window.location.href = href;
                                }
                                // nếu không có item đang active, để form submit bình thường
                            } else if (e.key === 'Escape') {
                                hide();
                            }
                        });

                        // Submit form: chuyển đến /products?q=...
                        form.addEventListener('submit', (e) => {
                            const q = input.value.trim();
                            if (!q) { e.preventDefault(); hide(); }
                        });
                    })();

                    /**/
                    (() => {
                        const form = document.getElementById('headerSearchForm');
                        const input = document.getElementById('headerSearch');
                        const btn = form?.querySelector('button[type="submit"]');
                        if (!form || !input || !btn) return;

                        // Click kính lúp: nếu ô trống => chỉ mở & focus (không submit)
                        btn.addEventListener('click', (e) => {
                            if (!input.value.trim()) { e.preventDefault(); form.classList.add('open'); input.focus(); }
                        });

                        // Rời khỏi input mà không gõ gì => thu gọn lại
                        input.addEventListener('blur', () => {
                            if (!input.value.trim()) form.classList.remove('open');
                        });
                    })();
                </script>
                <!-- Navbar End -->

                <div class="container py-3">
                    <nav aria-label="breadcrumb" class="mb-3">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="/">Trang chủ</a></li>
                            <li class="breadcrumb-item active" aria-current="page">So sánh sản phẩm</li>
                        </ol>
                    </nav>

                    <% /* Chuẩn hóa product để hiển thị: KHÔNG dùng && / || / ?: */ var list=[]; if (typeof products
                        !=='undefined' ) { if (products) { var i=0; for (i=0; i < products.length; i++) { var
                        p=products[i]; var item={ id: 0, name: '' , image: '' , price: 0, discount: 0, shortDesc: '' ,
                        factoryLabel: '-' , targetLabel: '-' , cpu: '-' , ramText: '-' , storageText: '-' ,
                        screenText: '-' , featuresText: '-' , qty: 0, finalPrice: 0 }; if (p.id) item.id=p.id; if
                        (p.name) item.name=String(p.name); if (p.image) item.image=String(p.image); if (typeof
                        p.price==='number' ) item.price=p.price; if (typeof p.discount==='number' )
                        item.discount=p.discount; if (p.shortDesc) item.shortDesc=String(p.shortDesc); /* factory */ if
                        (p.factory) { var f=String(p.factory); if (f==='APPLE' ) item.factoryLabel='Apple (MacBook)' ;
                        else if (f==='ASUS' ) item.factoryLabel='Asus' ; else if (f==='LENOVO' )
                        item.factoryLabel='Lenovo' ; else if (f==='DELL' ) item.factoryLabel='Dell' ; else if (f==='LG'
                        ) item.factoryLabel='LG' ; else if (f==='ACER' ) item.factoryLabel='Acer' ; else if (f==='HP' )
                        item.factoryLabel='HP' ; else if (f==='MSI' ) item.factoryLabel='MSI' ; else if (f==='GIGABYTE'
                        ) item.factoryLabel='Gigabyte' ; else if (f==='ALIENWARE' ) item.factoryLabel='Alienware' ; else
                        item.factoryLabel=f; } /* target */ if (p.target) { var t=String(p.target); if (t==='GAMING' )
                        item.targetLabel='Gaming' ; else if (t==='SINHVIEN-VANPHONG' )
                        item.targetLabel='Sinh viên - Văn phòng' ; else if (t==='THIET-KE-DO-HOA' )
                        item.targetLabel='Thiết kế đồ họa' ; else if (t==='MONG-NHE' ) item.targetLabel='Mỏng nhẹ' ;
                        else if (t==='DOANH-NHAN' ) item.targetLabel='Doanh nhân' ; else item.targetLabel=t; } if
                        (p.cpu) item.cpu=String(p.cpu); if (typeof p.ramGB==='number' ) { item.ramText=String(p.ramGB)
                        + ' GB' ; } if (typeof p.storageGB==='number' ) { var stype='SSD' ; if (p.storageType)
                        stype=String(p.storageType); item.storageText=String(p.storageGB) + ' GB ' + stype; } var
                        resText='' ; if (p.screenResolution) { resText=String(p.screenResolution); if (resText==='FHD' )
                        resText='FHD (1920×1080)' ; else if (resText==='QHD' ) resText='QHD / 2K' ; else if
                        (resText==='4K' ) resText='4K UHD' ; } if (typeof p.screenSizeInches==='number' ) { var
                        sz=String(p.screenSizeInches); if (sz.indexOf('.0') !==-1) { sz=sz.replace('.0',''); } if
                        (resText.length> 0) item.screenText = sz + '" '
                        + resText;
                        else item.screenText = sz + '"';
                        } else {
                        if (resText.length > 0) item.screenText = resText;
                        }

                        var features = [];
                        if (p.featureTags) {
                        if (typeof p.featureTags === 'string') {
                        var norm = p.featureTags;
                        if (norm.indexOf('|') !== -1) { norm = norm.split('|').join(';'); }
                        var parts = norm.split(';');
                        var j = 0;
                        for (j = 0; j < parts.length; j++) { var ft=parts[j]; if (ft) { ft=ft.trim(); if (ft.length> 0)
                            features.push(ft);
                            }
                            }
                            }
                            }
                            if (features.length > 0) {
                            item.featuresText = features.join(', ');
                            } else {
                            item.featuresText = '';
                            }

                            if (typeof p.quantity === 'number') item.qty = p.quantity;

                            item.finalPrice = item.price;
                            if (item.discount > 0) {
                            item.finalPrice = Math.round(item.price * (100 - item.discount) / 100);
                            }

                            list.push(item);
                            }
                            }
                            }
                            %>

                            <div class="d-flex align-items-center justify-content-between cmp-top-actions mb-3">
                                <div>
                                    <a href="/products" class="btn btn-outline-secondary btn-sm"><i
                                            class="fa fa-arrow-left me-1"></i> Tiếp tục mua</a>
                                </div>
                                <div>
                                    <a href="/compare?ids=<%= (ids && ids.length) ? ids.join(',') : '' %>"
                                        class="btn btn-primary btn-sm">
                                        Làm mới trang so sánh
                                    </a>
                                </div>
                            </div>

                            <% if (list.length===0) { %>
                                <div class="alert alert-info">Chưa có sản phẩm nào để so sánh. Hãy thêm sản phẩm bằng
                                    nút
                                    “So
                                    sánh” ở trang sản phẩm.</div>
                                <% } %>

                                    <% if (list.length> 0) { %>
                                        <div class="table-responsive">
                                            <table class="table cmp-table">
                                                <thead>
                                                    <tr>
                                                        <th class="cmp-spec">Thuộc tính</th>
                                                        <% var k=0; for (k=0; k<list.length; k++){ %>
                                                            <th class="text-center cmp-header">
                                                                <a href="/product/<%= list[k].id %>">
                                                                    <img src="/images/product/<%= list[k].image %>"
                                                                        alt="prod">
                                                                </a>
                                                                <div class="cmp-name mt-2"><a
                                                                        href="/product/<%= list[k].id %>"
                                                                        class="text-decoration-none">
                                                                        <%= list[k].name %>
                                                                    </a></div>
                                                                <div class="small text-muted">
                                                                    <%= list[k].shortDesc %>
                                                                </div>
                                                                <div class="mt-1">
                                                                    <span class="cmp-remove"
                                                                        data-id="<%= list[k].id %>"><i
                                                                            class="fa fa-times"></i> Xóa</span>
                                                                </div>
                                                            </th>
                                                            <% } %>
                                                    </tr>
                                                </thead>
                                                <tbody id="cmpBody">
                                                    <!-- Giá -->
                                                    <tr data-row="price">
                                                        <td class="cmp-spec">Giá</td>
                                                        <% var a=0; for (a=0; a<list.length; a++){ %>
                                                            <td>
                                                                <% if (list[a].discount> 0) { %>
                                                                    <div class="cmp-price">
                                                                        <div class="old">
                                                                            <%= new
                                                                                Intl.NumberFormat('vi-VN',{style:'currency',currency:'VND'}).format(list[a].price)
                                                                                %>
                                                                        </div>
                                                                        <div class="new">
                                                                            <%= new
                                                                                Intl.NumberFormat('vi-VN',{style:'currency',currency:'VND'}).format(list[a].finalPrice)
                                                                                %>
                                                                        </div>
                                                                    </div>
                                                                    <% } else { %>
                                                                        <div class="cmp-price">
                                                                            <div class="new">
                                                                                <%= new
                                                                                    Intl.NumberFormat('vi-VN',{style:'currency',currency:'VND'}).format(list[a].price)
                                                                                    %>
                                                                            </div>
                                                                        </div>
                                                                        <% } %>
                                                            </td>
                                                            <% } %>
                                                    </tr>

                                                    <!-- Hãng -->
                                                    <tr data-row="factory">
                                                        <td class="cmp-spec">Hãng</td>
                                                        <% var b=0; for (b=0; b<list.length; b++){ %>
                                                            <td>
                                                                <%= list[b].factoryLabel %>
                                                            </td>
                                                            <% } %>
                                                    </tr>

                                                    <!-- Mục đích -->
                                                    <tr data-row="target">
                                                        <td class="cmp-spec">Mục đích</td>
                                                        <% var c=0; for (c=0; c<list.length; c++){ %>
                                                            <td>
                                                                <%= list[c].targetLabel %>
                                                            </td>
                                                            <% } %>
                                                    </tr>

                                                    <!-- CPU -->
                                                    <tr data-row="cpu">
                                                        <td class="cmp-spec">CPU</td>
                                                        <% var d=0; for (d=0; d<list.length; d++){ %>
                                                            <td>
                                                                <%= list[d].cpu %>
                                                            </td>
                                                            <% } %>
                                                    </tr>

                                                    <!-- RAM -->
                                                    <tr data-row="ram">
                                                        <td class="cmp-spec">RAM</td>
                                                        <% var e=0; for (e=0; e<list.length; e++){ %>
                                                            <td>
                                                                <%= list[e].ramText %>
                                                            </td>
                                                            <% } %>
                                                    </tr>

                                                    <!-- Ổ cứng -->
                                                    <tr data-row="storage">
                                                        <td class="cmp-spec">Ổ cứng</td>
                                                        <% var f=0; for (f=0; f<list.length; f++){ %>
                                                            <td>
                                                                <%= list[f].storageText %>
                                                            </td>
                                                            <% } %>
                                                    </tr>

                                                    <!-- Màn hình -->
                                                    <tr data-row="screen">
                                                        <td class="cmp-spec">Màn hình</td>
                                                        <% var g=0; for (g=0; g<list.length; g++){ %>
                                                            <td>
                                                                <%= list[g].screenText %>
                                                            </td>
                                                            <% } %>
                                                    </tr>

                                                    <!-- Tính năng -->
                                                    <tr data-row="features">
                                                        <td class="cmp-spec">Tính năng</td>
                                                        <% var h=0; for (h=0; h<list.length; h++){ %>
                                                            <td>
                                                                <%= list[h].featuresText %>
                                                            </td>
                                                            <% } %>
                                                    </tr>

                                                    <!-- Tồn kho -->
                                                    <tr data-row="qty">
                                                        <td class="cmp-spec">Tồn kho</td>
                                                        <% var z=0; for (z=0; z<list.length; z++){ %>
                                                            <td>
                                                                <%= list[z].qty %>
                                                            </td>
                                                            <% } %>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <% } %>
                </div>

                <link rel="stylesheet" href="/client/css/layout/footer.css">
                <!-- Footer Start -->
                <div class="container-fluid bg-dark text-white-50 footer pt-5 mt-5">
                    <div class="container py-5">
                        <div class="row g-5">
                            <!-- Logo & Giới thiệu -->
                            <div class="col-lg-3 col-md-6">
                                <a href="/" class="d-inline-block mb-3">
                                    <h2 class="text-primary fw-bold">LaptopShop</h2>
                                </a>
                                <p class="small">
                                    Chúng tôi cam kết mang đến sản phẩm <span class="text-light">chính hãng</span>,
                                    dịch vụ tận tâm và giá cả cạnh tranh nhất.
                                </p>
                                <!-- Icon mạng xã hội -->
                                <div class="d-flex pt-2">
                                    <a class="btn btn-outline-light btn-social me-2 rounded-circle" href="#"><i
                                            class="fab fa-facebook-f"></i></a>
                                    <a class="btn btn-outline-light btn-social me-2 rounded-circle" href="#"><i
                                            class="fab fa-instagram"></i></a>
                                    <a class="btn btn-outline-light btn-social me-2 rounded-circle" href="#"><i
                                            class="fab fa-youtube"></i></a>
                                    <a class="btn btn-outline-light btn-social rounded-circle" href="#"><i
                                            class="fab fa-tiktok"></i></a>
                                </div>
                            </div>

                            <!-- Thông tin cửa hàng -->
                            <div class="col-lg-3 col-md-6">
                                <h4 class="text-light mb-3">Thông tin cửa hàng</h4>
                                <a class="btn-link d-block mb-2" href="/about">Về chúng tôi</a>
                                <a class="btn-link d-block mb-2" href="/privacy">Chính sách bảo mật</a>
                                <a class="btn-link d-block mb-2" href="/terms">Điều khoản & dịch vụ</a>
                                <a class="btn-link d-block" href="/support">FAQs & Hỗ trợ</a>
                            </div>

                            <!-- Tài khoản -->
                            <div class="col-lg-3 col-md-6">
                                <h4 class="text-light mb-3">Tài khoản</h4>
                                <a class="btn-link d-block mb-2" href="/profile">Tài khoản của tôi</a>
                                <a class="btn-link d-block mb-2" href="/cart">Giỏ hàng</a>
                                <a class="btn-link d-block mb-2" href="/order-user">Đơn hàng</a>
                                <a class="btn-link d-block" href="/blogs">Blogs</a>
                            </div>

                            <!-- Liên hệ -->
                            <div class="col-lg-3 col-md-6">
                                <h4 class="text-light mb-3">Liên hệ</h4>
                                <p><i class="fas fa-map-marker-alt me-2 text-primary"></i>99 ABC, Thống Nhất, Gò Vấp</p>
                                <p><i class="fas fa-envelope me-2 text-primary"></i>vuonghuynhitk3@gmail.com</p>
                                <p><i class="fas fa-phone-alt me-2 text-primary"></i>0999 887 744</p>
                                <p><i class="fas fa-clock me-2 text-primary"></i>Cả tuần (8:00 - 20:00)</p>
                                <!-- Form đăng ký nhận tin -->
                                <form class="mt-3">
                                    <div class="input-group">
                                        <input type="email" class="form-control border-0"
                                            placeholder="Nhập email của bạn">
                                        <button class="btn btn-primary">Đăng ký</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Copyright -->
                <div class="container-fluid bg-dark copyright bg-black py-3">
                    <div
                        class="container d-flex flex-column flex-md-row justify-content-between text-center text-md-start">
                        <span class="text-light mb-2 mb-md-0">
                            <i class="fas fa-copyright me-2"></i>2025
                            <a href="#" class="text-primary fw-bold">VuongHuynh-LaptopShop</a>. All rights reserved.
                        </span>
                        <span class="text-white">
                            Designed by <a class="text-primary border-bottom" href="https://htmlcodex.com">HTML
                                Codex</a> |
                            Distributed by <a class="text-primary border-bottom"
                                href="https://themewagon.com">ThemeWagon</a>
                        </span>
                    </div>
                </div>
                <!-- Footer End -->

                <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
                <script>
                    // Highlight các dòng có giá trị khác nhau
                    (function () {
                        var tbody = document.getElementById('cmpBody');
                        if (!tbody) return;
                        var rows = tbody.querySelectorAll('tr');
                        for (var i = 0; i < rows.length; i++) {
                            var tds = rows[i].querySelectorAll('td:not(.cmp-spec)');
                            if (!tds || !tds.length) continue;
                            var base = tds[0].textContent.trim();
                            var allSame = true;
                            for (var j = 1; j < tds.length; j++) {
                                if (tds[j].textContent.trim() !== base) { allSame = false; break; }
                            }
                            if (!allSame) { rows[i].classList.add('cmp-diff'); }
                        }

                        // Xóa 1 sản phẩm khỏi so sánh (client-side + quay về /compare mới)
                        $(document).on('click', '.cmp-remove', function () {
                            var id = $(this).data('id');
                            try {
                                var arr = JSON.parse(localStorage.getItem('compareList') || '[]');
                                arr = arr.filter(function (x) { return String(x.id) !== String(id); });
                                localStorage.setItem('compareList', JSON.stringify(arr));
                            } catch (e) { }
                            // reload với ids mới (nếu có)
                            var ids = [];
                            try {
                                var arr2 = JSON.parse(localStorage.getItem('compareList') || '[]');
                                for (var k = 0; k < arr2.length; k++) { ids.push(arr2[k].id); }
                            } catch (e) { }
                            if (ids.length > 0) {
                                window.location.href = '/compare?ids=' + ids.join(',');
                            } else {
                                window.location.href = '/compare';
                            }
                        });
                    })();
                </script>
</body>

</html>